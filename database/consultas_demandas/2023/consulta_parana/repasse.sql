\COPY (SELECT tb_recursos_osc.*, dc_fonte_recursos_osc.*, lpad(tb_osc.cd_identificador_osc::TEXT, 14, '0') AS cd_identificador_osc, NULLIF(btrim(tb_dados_gerais.tx_razao_social_osc), '') AS tx_razao_social_osc, NULLIF(btrim(tb_dados_gerais.tx_nome_fantasia_osc), '') AS tx_nome_fantasia_osc, NULLIF(btrim(tb_localizacao.tx_endereco), '') AS tx_endereco, tb_localizacao.nr_localizacao, NULLIF(btrim(tb_localizacao.tx_endereco_complemento), '') AS tx_endereco_complemento, NULLIF(btrim(tb_localizacao.tx_bairro), '') AS tx_bairro, tb_localizacao.cd_municipio::TEXT, ed_municipio.edmu_nm_municipio::TEXT, ed_uf.eduf_sg_uf::TEXT AS tx_sigla_uf FROM osc.tb_osc LEFT JOIN osc.tb_dados_gerais ON tb_osc.id_osc = tb_dados_gerais.id_osc LEFT JOIN osc.tb_localizacao ON tb_osc.id_osc = tb_localizacao.id_osc LEFT JOIN spat.ed_municipio ON ed_municipio.edmu_cd_municipio = tb_localizacao.cd_municipio LEFT JOIN spat.ed_uf ON ed_uf.eduf_cd_uf = substr(tb_localizacao.cd_municipio::TEXT, 0, 3)::NUMERIC(2,0) JOIN osc.tb_recursos_osc on tb_osc.id_osc = tb_recursos_osc.id_osc LEFT JOIN syst.dc_fonte_recursos_osc on tb_recursos_osc.cd_fonte_recursos_osc = dc_fonte_recursos_osc.cd_fonte_recursos_osc WHERE tb_osc.bo_osc_ativa AND ed_uf.eduf_sg_uf = 'PR') TO 'repasse_governo.csv' WITH (FORMAT CSV, HEADER, DELIMITER ';');